{% extends "shared/base.html" %}

{% block title %}BReader - Feeds{% endblock %}

{% block content %}
<a href="#myModal" role="button" class="btn btn-mini btn-primary" data-toggle="modal"><i class="icon-plus icon-white"></i> New</a>
<a href="#myModal2" role="button" class="btn btn-mini btn-primary" data-toggle="modal"><i class="icon-upload icon-white"></i> Import</a>
<table class="table">
  <tbody>
    {% for item in feeds %}
    <tr>
      <td><strong>{{ item.name }}</strong><br>{{ item.url }}</td>
      <td><a href="#" onclick="javascript:alert_delete('{{ item.key.urlsafe() }}'); return false;"><i class="icon-trash"></i> Delete</a></td>
    </tr>
    {% endfor %}
  </tbody>
</table>
<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">New Feed</h3>
  </div>
  <form method="post" action="/feed_new" class="form-horizontal">
    <div class="modal-body">
      <div class="control-group">
        <label class="control-label" for="url">URL</label>
        <div class="controls">
          <input type="text" id="url" name="url" placeholder="URL">
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-primary">Save</button>
    </div>
  </form>
</div>
<div id="dialog-confirm" title="Delete Feed?" style="display: none">
    <p><span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 20px 0;"></span>This feed will be permanently deleted. Are you sure?</p>
</div>

<div id="myModal2" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel2" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel2">Import Feeds</h3>
  </div>
  <form method="post" action="/feed_import" class="form-horizontal" enctype="multipart/form-data">
    <div class="modal-body">
      <div class="control-group">
        <label class="control-label" for="url">File</label>
        <div class="controls">
          <input type="file" id="file" name="file" placeholder="File">
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-primary">Save</button>
    </div>
  </form>
</div>
<div id="dialog-confirm2" title="Delete Feed?" style="display: none">
    <p><span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 20px 0;"></span>This feed will be permanently deleted. Are you sure?</p>
</div>
{% endblock %}
{% block script %}
<script>
  $(function() {
    $("#dialog-confirm2").dialog({
      autoOpen: false,
      resizable: false,
      height:180,
      modal: true,
      buttons: {
        "Delete Feed": function() {
          window.location = "/feed_delete?id=" + $(this).dialog( "option", "my_key" );
        },
        Cancel: function() {
          $( this ).dialog("close");
        }
      }
    });
  });
  function alert_delete(key){
    $("#dialog-confirm2").dialog("option", "my_key", key);
    $("#dialog-confirm2").dialog("open");
    return false;
  }
</script>
{% endblock %}
